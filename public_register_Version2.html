<!doctype html>
<html lang="ja">
<head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Register</title><link rel="stylesheet" href="/css/styles.css"></head>
<body class="centered-page">
  <main class="panel auth">
    <h2>アカウント登録</h2>
    <form id="regForm">
      <label>ユーザー名</label>
      <input id="rusername" required />
      <label>パスワード</label>
      <input id="rpassword" type="password" required />
      <div style="margin-top:12px">
        <button type="submit" class="btn">登録</button>
        <a href="/login.html" class="btn ghost">ログイン</a>
      </div>
    </form>
    <div id="msg" class="small"></div>
  </main>
<script>
document.getElementById('regForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const u = document.getElementById('rusername').value;
  const p = document.getElementById('rpassword').value;
  try {
    const r = await fetch('/api/register', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({ username: u, password: p })});
    const j = await r.json();
    if (!r.ok) { document.getElementById('msg').textContent = j.error || 'Register failed'; return; }
    document.getElementById('msg').textContent = '登録完了。ログインしてください。';
  } catch (err) { document.getElementById('msg').textContent = 'Error'; }
});
</script>
</body>
</html>